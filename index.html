<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Isho Dolls | NFT Minting Experience</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&family=Zen+Kaku+Gothic+New:wght@400;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/png" href="./images/favicon-japanese-ink-icon_32x32.png">
    <script src="https://cdn.jsdelivr.net/npm/p5@1.8.0/lib/p5.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.8.0/dist/ethers.umd.min.js"></script>
    <script src="https://unpkg.com/@web3modal/standalone"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://unpkg.com/@walletconnect/web3-provider@1.8.0/dist/umd/index.min.js"></script>
    <style>
        :root {
            --sumi-black: #1A1818;
            --washi-cream: #F5F0E6;
            --vermillion: #6bc876;
            --gold-leaf: #daae29;
            --wallet-connect: #b747a1;
            --wallet-hover: #d57ac0;
            --maroon: #6B2D2D;
        }

        @font-face {
            font-family: 'Isho';
            src: url('./isho.ttf') format('truetype');
            font-weight: normal;
            font-style: normal;
            font-display: swap;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Zen Kaku Gothic New', 'Noto Sans JP', sans-serif;
            background-color: var(--washi-cream);
            color: var(--sumi-black);
            overflow-x: hidden;
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('./images/Nash.jpg');
            opacity: 0.85;
            z-index: -1;
            pointer-events: none;
        }
        
        #ink-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            pointer-events: none;
        }

        /* Flower canvas with highest priority */
        #flower-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 99999 !important;
            pointer-events: none;
            opacity: 1 !important;
        }
        
        #ink-controls {
            position: fixed;
            display: none;
            top: 80px;
            right: 10px;
            background: rgba(245, 240, 230, 0.95);
            padding: 15px;
            border-radius: 8px;
            font-family: 'Zen Kaku Gothic New', sans-serif;
            font-size: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid var(--gold-leaf);
            z-index: 50;
            min-width: 200px;
        }
        
        #toggleInkControls {
            position: fixed;
            bottom: 70px;
            right: 10px;
            padding: 8px 12px;
            background: rgba(245, 240, 230, 0.95);
            border: 1px solid var(--vermillion);
            border-radius: 4px;
            cursor: pointer;
            z-index: 100;
            font-family: inherit;
            font-size: 11px;
            color: var(--sumi-black);
            transition: all 0.3s ease;
        }
        
        #toggleInkControls:hover {
            background: var(--vermillion);
            color: var(--washi-cream);
        }
        
        .ink-control-group {
            margin-bottom: 12px;
        }
        
        .ink-control-group label {
            display: block;
            margin-bottom: 4px;
            font-weight: 500;
            color: var(--sumi-black);
        }
        
        .ink-control-group input[type="range"] {
            width: 100%;
            margin-bottom: 5px;
        }
        
        .ink-color-picker {
            width: 100%;
            height: 25px;
            cursor: pointer;
            border: 1px solid var(--sumi-black);
            border-radius: 3px;
        }
        
        #clearInkBtn {
            width: 100%;
            padding: 8px;
            background: var(--vermillion);
            color: var(--washi-cream);
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-weight: 500;
            transition: background 0.3s ease;
        }
        
        #clearInkBtn:hover {
            background: var(--maroon);
        }
        
        header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 1rem 2rem;
            background-color: rgba(26, 24, 24, 0.9);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid var(--gold-leaf);
            pointer-events: auto;
        }

        .japanese-text {
            text-shadow: 
                1px 1px 0px #8c6a56,
                2px 2px 0px #7a5a47,
                3px 3px 6px rgba(0, 0, 0, 0.4);
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
        }

        .logo {
            font-size: 2.9rem;
            font-weight: 900;
            color: var(--washi-cream);
            letter-spacing: 2px;
            display: flex;
            align-items: center;
            font-family: 'Isho', sans-serif;
        }
                
        .logo span {
            color: var(--gold-leaf);
            margin-left: 0.5rem;
        }

        #connect-wallet {       
            background-color: rgb(168, 97, 118);
            color: var(--washi-cream);
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 4px;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            min-width: 240px;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            pointer-events: auto;
            position: relative;
            z-index: 1;
        }

        #connect-wallet:hover {
            background-color: rgb(208, 114, 142);
            transform: translateY(-2px);
            min-width: 240px;
        }
        
        #connect-wallet.connected {
            background-color: var(--gold-leaf);
            color: var(--sumi-black);
            min-width: 240px;
        }
        
        #hero {
            height: 140vh;
            background: 
                linear-gradient(135deg, rgba(74, 144, 226, 0.4), rgba(80, 227, 194, 0.6)),
                url('./images/Yoshida.jpg');
            background-size: cover;
            background-position: center;
            background-blend-mode: multiply;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            opacity: .8;
            padding: 0 2rem;
            position: relative;
        }

        .hero-content {
            max-width: 600px;
            transform: translate(-0px, 70vh);
            margin: 0 auto;
            z-index: 10;
            margin-top: -65vh;
            opacity: 1 !important;
        }
        
        .hero-title {
            font-size: 4rem;
            font-weight: 700;
            color: var(--sumi-black);
            margin-bottom: 1rem;
            opacity: 1 !important;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .hero-title span {
            color: var(--vermillion);
            opacity: 1 !important;
        }
        
        .hero-subtitle {
            font-size: 1.5rem;
            color: var(--sumi-black);
            margin-bottom: 2rem;
            opacity: 0.9;
        }
        
        .ink-interaction-hint {
            position: absolute;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(26, 24, 24, 0.8);
            color: var(--washi-cream);
            padding: 1rem 2rem;
            border-radius: 8px;
            text-align: center;
            animation: fadeInOut 3s infinite;
            z-index: 5;
        }
        
        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }
        
        .hero-logo {
            width: 200px;
            height: 200px;
            margin-bottom: 2rem;
            background-image: url('./images/japanese-ink-circle-logo_400x400.png');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            display: none;
            filter: drop-shadow(0 0 10px rgba(212, 175, 55, 0.3));
        }
        
        #gallery {
            padding: 5rem 2rem;
            margin-top: -5vh;
            background-color: rgba(245, 240, 230, 0);
            z-index: 1000000000000 !important;
            opacity: 1 !important;
        }
        
        .gallery-title {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 3rem;
            color: var(--sumi-black);
            position: relative;
        }
        
        .gallery-title::after {
            content: "";
            display: block;
            width: 100px;
            height: 3px;
            background-color: var(--vermillion);
            margin: 1rem auto 0;
        }
        
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .nft-card {
            background-color: var(--washi-cream);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid rgba(203, 75, 22, 0.2);
        }
        
        .nft-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }
        
        .nft-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('./images/pencil-sketch-texture_600x600.png');
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .nft-card:hover::before {
            opacity: 0.1;
        }
        
        .nft-image {
            width: 100%;
            border: 2px solid black;
            border-radius: 5px;
            height: 300px;
            object-fit: cover;
            border-bottom: 1px solid rgba(203, 75, 22, 0.1);
        }
        
        .nft-info {
            padding: 1.5rem;
            border: 1px solid black;
            border-top: none;
            background: linear-gradient(to top, #1e0808, #c4c0b6);
        }
        
        .nft-name {
            font-size: 1.5rem;
            font-weight: 700;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin-bottom: 0.5rem;
            color: var(--sumi-black);
        }
        
        .nft-description {
            font-size: 0.9rem;
            color: rgba(26, 24, 24, 0.7);
            margin-bottom: 1rem;
        }
        
        .nft-price {
            font-size: 1.1rem;
            font-weight: 700;
            font-family:'Times New Roman', Times, serif;
            color: var(--vermillion);
        }
        
        #mint-section {
            padding: 5rem 2rem;
            background-color: rgba(26, 24, 24, 0.95);
            color: var(--washi-cream);
        }
        
        .mint-container {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            margin-top: 14vh;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            opacity: 1 !important;
            padding-bottom: 6vh;
            transform: scale(.92, 1.05);
            z-index: 1000000000 !important;
        }
        
        .collection-info {
            padding: 2rem;
            background-color: rgba(245, 240, 230, 0.525);
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.2);
            position: relative;
        }
        
        .collection-info::after {
            content: "";
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            background-image: url('./images/japanese-hanko-seal_150x150.png');
            background-size: contain;
            background-repeat: no-repeat;
            opacity: 0.3;
        }
        
        .collection-title {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--gold-leaf);
        }
        
        .collection-subtitle {
            font-size: 1.5rem;
            margin-bottom: .5rem;
            opacity: 0.8;
            font-family: 'Isho', sans-serif;
        }
        
        .collection-description {
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        #countdown-timer {
            font-size: 2.2rem;
            font-weight: 700;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
        }
        
        .milady-benefit {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding: 1rem;
            background-color: rgba(203, 75, 22, 0.1);
            border-radius: 4px;
            border-left: 3px solid var(--vermillion);
        }
        
        .milady-icon {
            width: 30px;
            height: 30px;
            margin-right: 1rem;
            background-image: url('./images/milady-aura-icon_60x60.png');
            background-size: contain;
            background-repeat: no-repeat;
        }
        
        .mint-interface {
            padding: 1rem;
            background-color: var(--washi-cream);
            border-radius: 8px;
            transform: scale(.85);
            color: var(--sumi-black);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .countdown {
            font-family: 'Noto Sans JP', sans-serif;
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            color: var(--sumi-black);
        }
        
        .countdown-label {
            font-size: 1rem;
            opacity: 0.7;
            margin-bottom: 0.5rem;
        }
        
        .progress-container {
            width: 100%;
            margin-bottom: 2rem;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 10px;
            background-color: rgba(26, 24, 24, 0.1);
            border-radius: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background-color: var(--vermillion);
            width: 0%;
            transition: width 0.5s ease;
        }
        
        .milady-check {
            display: none;
            align-items: center;
            margin-bottom: 2rem;
            padding: 0.8rem 1.5rem;
            background-color: rgba(212, 175, 55, 0.1);
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .milady-check.verified {
            background-color: rgba(107, 45, 45, 0.1);
            border-left: 3px solid var(--maroon);
        }
        
        .milady-check-icon {
            width: 20px;
            height: 20px;
            margin-right: 0.5rem;
            background-image: url('./images/milady-check-icon_40x40.png');
            background-size: contain;
            background-repeat: no-repeat;
        }

        .quantity-selector {
            margin-bottom: 2rem;
            padding: 1.5rem;
            min-width: 380px;
            background-color: rgba(212, 175, 55, 0.1);
            border-radius: 8px;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .quantity-label {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 1rem;
            text-align: center;
            color: var(--sumi-black);
        }

        .quantity-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 1rem;
        }

        .quantity-btn {
            padding: 12px 8px;
            background: linear-gradient(145deg, #e6e6e6, #cccccc);
            border: 2px solid #999999;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            font-weight: 900;
            color: #333333;
            cursor: pointer;
            transition: all 0.1s ease;
            position: relative;
            box-shadow: 
                inset 2px 2px 4px rgba(255, 255, 255, 0.8),
                inset -2px -2px 4px rgba(0, 0, 0, 0.2),
                2px 2px 4px rgba(0, 0, 0, 0.1);
            text-shadow: 1px 1px 1px rgba(255, 255, 255, 0.8);
        }

        .quantity-btn:hover {
            background: linear-gradient(145deg, #f0f0f0, #d6d6d6);
            transform: translateY(-1px);
            box-shadow: 
                inset 2px 2px 4px rgba(255, 255, 255, 0.9),
                inset -2px -2px 4px rgba(0, 0, 0, 0.15),
                3px 3px 6px rgba(0, 0, 0, 0.15);
        }

        .quantity-btn:active {
            transform: translateY(1px);
            background: linear-gradient(145deg, #cccccc, #b8b8b8);
            box-shadow: 
                inset -2px -2px 4px rgba(255, 255, 255, 0.6),
                inset 2px 2px 4px rgba(0, 0, 0, 0.3),
                1px 1px 2px rgba(0, 0, 0, 0.1);
        }

        .quantity-btn.active {
            background: linear-gradient(145deg, var(--vermillion), #5ba86b);
            color: var(--washi-cream);
            border-color: #4a7c54;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
            box-shadow: 
                inset 2px 2px 4px rgba(255, 255, 255, 0.3),
                inset -2px -2px 4px rgba(0, 0, 0, 0.4),
                2px 2px 4px rgba(0, 0, 0, 0.2);
        }

        .quantity-btn.active:hover {
            background: linear-gradient(145deg, #7bc886, #6bb876);
            transform: translateY(-1px);
        }

        .quantity-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
        }

        .quantity-price {
            font-weight: 700;
            color: var(--sumi-black);
        }

        .quantity-price span {
            color: var(--vermillion);
            font-size: 1.1rem;
        }

        .quantity-discount {
            font-size: 0.85rem;
            color: var(--maroon);
            font-weight: 600;
        }

        @media (max-width: 480px) {
            .quantity-buttons {
                grid-template-columns: repeat(2, 1fr);
                gap: 10px;
            }
            
            .quantity-btn {
                padding: 14px 10px;
                font-size: 1.2rem;
            }
        }
                
        #mint-button {
            background-color: var(--vermillion);
            color: var(--washi-cream);
            border: none;
            padding: 1.2rem 2.5rem;
            border-radius: 4px;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(203, 75, 22, 0.3);
            width: 100%;
            margin-bottom: 1rem;
        }
        
        #mint-button:hover {
            background-color: rgb(99, 160, 90);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(203, 75, 22, 0.4);
        }
        
        #mint-button:disabled {
            background-color: rgba(26, 24, 24, 0.476) !important;
            color: rgba(26, 24, 24, 0.5); 
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .mint-price {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .mint-price span {
            font-weight: 700;
            color: var(--vermillion);
        }
        
        footer {
            background-color: var(--sumi-black);
            color: var(--washi-cream);
            padding: 2rem;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin-bottom: 1rem;
        }
        
        .footer-link {
            color: var(--washi-cream);
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .footer-link:hover {
            color: var(--gold-leaf);
        }
        
        .copyright {
            opacity: 0.7;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        @media (max-width: 700px) {
            .logo {
                display: none;
            }
            html, body {
                height: 100vh !important;
                max-height: 100vh !important;
                overflow-x: hidden !important;
            }

            /* Keep your existing body::before fix */
            body::before {
                content: "";
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100vh;
                background-image: url('./images/Nash.jpg');
                opacity: 0.85;
                z-index: -1;
                pointer-events: none;
            }

            .gallery-grid {
                display: flex;
                flex-direction: row;
                overflow-x: auto;
                overflow-y: hidden;
                gap: 1rem;
                padding: 0 1rem;
                margin: 0;
                max-width: 100%;
                -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
                scrollbar-width: thin; /* Firefox */
            }

            /* Custom scrollbar for webkit browsers */
            .gallery-grid::-webkit-scrollbar {
                height: 8px;
            }

            .gallery-grid::-webkit-scrollbar-track {
                background: rgba(245, 240, 230, 0.3);
                border-radius: 4px;
            }

            .gallery-grid::-webkit-scrollbar-thumb {
                background: var(--vermillion);
                border-radius: 4px;
            }

            .gallery-grid::-webkit-scrollbar-thumb:hover {
                background: var(--gold-leaf);
            }

            .nft-card {
                flex: 0 0 280px; /* Fixed width, no shrinking */
                min-width: 280px;
                max-width: 280px;
                background-color: var(--washi-cream);
                border-radius: 8px;
                overflow: hidden;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                transition: all 0.3s ease;
                position: relative;
                border: 1px solid rgba(203, 75, 22, 0.2);
            }

                .nft-card:hover {
                transform: translateY(-0px);
                box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
            }

            .nft-image {
                width: 100%;
                border: 2px solid black;
                border-radius: 5px;
                height: 200px; /* Slightly smaller for mobile */
                object-fit: cover;
                border-bottom: 1px solid rgba(203, 75, 22, 0.1);
            }

            .nft-info {
                padding: 1rem; /* Reduced padding for mobile */
                border: 1px solid black;
                border-top: none;
                background: linear-gradient(to top, #1e0808, #c4c0b6);
            }

            .nft-name {
                font-size: 1.2rem; /* Slightly smaller font */
                font-weight: 700;
                font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                margin-bottom: 0.5rem;
                color: var(--sumi-black);
            }

            .nft-price {
                font-size: 1rem; /* Slightly smaller font */
                font-weight: 700;
                font-family:'Times New Roman', Times, serif;
                color: var(--vermillion);
            }

            .mint-container {
                grid-template-columns: 1fr;
            }
            
            .hero-title {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
            }
            
            #ink-controls {
                right: 5px;
                padding: 10px;
                min-width: 150px;
            }
            
            #toggleInkControls {
                bottom: 10px;
                right: 5px;
            }

            #connect-wallet {       
                background-color: rgb(168, 97, 118);
                color: var(--washi-cream);
                border: none;
                padding: 0.8rem 1.5rem;
                border-radius: 4px;
                font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
                font-size: 1rem;
                font-weight: 700;
                cursor: pointer;
                min-width: 84vw;
                transition: all 0.3s ease;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
                pointer-events: auto;
                position: relative;
                z-index: 1;
            }

            #connect-wallet:hover {
                background-color: rgb(208, 114, 142);
                transform: translateY(-2px);
                min-width: 240px;
            }
            
            #connect-wallet.connected {
                background-color: var(--gold-leaf);
                color: var(--sumi-black);
                min-width: 240px;
            }

            .collection-info {
                padding: 1rem;
                background-color: rgba(245, 240, 230, 0.525);
                border-radius: 8px;
                border: 1px solid rgba(212, 175, 55, 0.2);
                position: relative;
                width: 100vw;
                margin-top: 8px;
                border: 1px solid rgb(68, 59, 59);
            }
            
            .collection-info::after {
                content: "";
                position: absolute;
                bottom: 20px;
                right: 20px;
                width: 80px;
                height: 80px;
                background-image: url('./images/japanese-hanko-seal_150x150.png');
                background-size: contain;
                background-repeat: no-repeat;
                opacity: 0.3;
            }

            #gallery {
                padding: 2rem 0; /* Reduced top/bottom padding, removed side padding */
                margin-top: -5vh;
                background-color: rgba(245, 240, 230, 0);
                z-index: 1000000000000 !important;
                opacity: 1 !important;
            }

                
            .mint-interface {
                padding: 1rem;
                background-color: var(--washi-cream);
                border-radius: 8px;
                transform: scale(1) translateY(-20px);
                color: var(--sumi-black);
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
                display: flex;
                width: 100vw;
                flex-direction: column;
                align-items: center;
                border: 1px solid rgb(68, 59, 59);
            }

            #hero {
                height: 60vh;
                background: 
                    linear-gradient(135deg, rgba(74, 144, 226, 0.4), rgba(80, 227, 194, 0.6)),
                    url('./images/Yoshida.jpg');
                background-size: cover;
                background-position: center;
                background-blend-mode: multiply;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                text-align: center;
                opacity: .8;
                padding: 0 2rem;
                position: relative;
            }

            .hero-content {
                max-width: 600px;
                transform: translate(-0px, 70vh);
                margin: 0 auto;
                z-index: 10;
                margin-top: -65vh;
                opacity: 1 !important;
            }

            footer {
                position: relative;
                z-index: 100;
                margin-top: 0; /* Remove any top margin */
            }

            
        }
        
    
    </style>
</head>
<body>
    <div id="ink-canvas"></div>
    <div id="flower-canvas"></div>
    
    <div id="ink-controls">
        <div class="ink-control-group">
            <label for="viscosity">Viscosity</label>
            <input type="range" id="viscosity" min="0.1" max="1" step="0.05" value="0.5">
        </div>
        <div class="ink-control-group">
            <label for="flow">Flow</label>
            <input type="range" id="flow" min="0.1" max="2" step="0.1" value="1">
        </div>
        <div class="ink-control-group">
            <label for="fade">Fade Speed</label>
            <input type="range" id="fade" min="1" max="50" step="1" value="20">
        </div>
        <div class="ink-control-group">
            <label for="inkColor">Ink Color</label>
            <input type="color" id="inkColor" class="ink-color-picker" value="#1A1818">
        </div>
        <div class="ink-control-group">
            <label for="bgOpacity">Canvas Opacity</label>
            <input type="range" id="bgOpacity" min="0" max="1" step="0.1" value="0.8">
        </div>
        <button id="clearInkBtn">Clear Ink</button>
    </div>
    
    <header>
        <div class="logo">Isho Dolls &nbsp;<span>霊</span></div>
        <button id="connect-wallet">Connect Wallet</button>
    </header>

    <div class="mint-container">
        <div class="collection-info">
            <h2 class="collection-title">霊のコレクション</h2>
            <h3 class="collection-subtitle">Isho Dolls Collection</h3>
            <p class="collection-description">
                Isho Ningyo, or "fashion dolls," emerged in the late 17th century during Japan's prosperous Edo period. First inspired by famous actors or beautiful women, their styles evolved with changing trends to represent styles from all walks of life.
            </p>
            <div class="milady-benefit">
                <div class="milady-icon"></div>
                <p><span style="font-weight: 900;">Milady</span> and <span style="font-weight: 900;">Milady Aura</span> holders qualify for free mints during the first 24 hours</p>
            </div>
        </div>
        
        <div class="mint-interface">
            <div class="countdown">
                <div class="countdown-label">Minting Opens In</div>
                <div id="countdown-timer">To Be Announced</div>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">
                    <span>Minted</span>
                    <span id="minted-count">0/1000</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            
            <div class="milady-check" id="milady-check">
                <div class="milady-check-icon"></div>
                <span>Connect wallet to check Milady eligibility</span>
            </div>

            <div class="quantity-selector">
                <div class="quantity-label">Select Quantity</div>
                <div class="quantity-buttons">
                    <button class="quantity-btn active" data-quantity="1">1</button>
                    <button class="quantity-btn" data-quantity="5">5</button>
                    <button class="quantity-btn" data-quantity="10">10</button>
                    <button class="quantity-btn" data-quantity="20">20</button>
                </div>

                <div class="quantity-info">
                    <span class="quantity-price">Total: <span id="total-price">0.01 ETH</span></span>
                    <span class="quantity-discount" id="quantity-discount"></span>
                </div>
            </div>
            
            <button id="mint-button">Mint Coming Soon</button>
            <p class="mint-price">Price: <span>0.01 ETH</span> (Free for Milady holders)</p>
        </div>
    </div>
 
    <section id="hero">
        <section id="gallery">
            <div class="gallery-grid">
                <div class="nft-card">
                    <img src="./images/image4.png" alt="Ink Dragon NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #1</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
                <div class="nft-card">
                    <img src="./images/image5.png" alt="Phoenix NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #2</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
                <div class="nft-card">
                    <img src="./images/image3.png" alt="Samurai NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #3</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
                <div class="nft-card">
                    <img src="./images/image1.png" alt="Landscape NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #4</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
                <div class="nft-card">
                    <img src="./images/image2.png" alt="Landscape NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #5</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
                <div class="nft-card">
                    <img src="./images/image6.png" alt="Landscape NFT" class="nft-image">
                    <div class="nft-info">
                        <h3 class="nft-name">Isho #6</h3>
                        <p class="nft-price">0.01 ETH</p>
                    </div>
                </div>
            </div>
        </section>
    </section>
    
    <footer>
        <div class="footer-links">
            <a href="#" class="footer-link">Twitter</a>
            <a href="#" class="footer-link">Discord</a>
            <a href="#" class="footer-link">OpenSea</a>
            <a href="#" class="footer-link">About</a>
        </div>
        <p class="copyright">© 2025 Isho Dolls. All rights reserved.</p>
    </footer>
 
    <script>
        // Enhanced Ink Animation with p5.js
        const sketch = (p) => {
            // Ink trail particles
            let particles = [];
            let lastMouseX = 0;
            let lastMouseY = 0;
            let lastMouseTime = 0;
            let canvas;
            
            // Fixed control values (no sliders needed)
            const maxParticles = 150;
            const inkFlow = 5;
            const dispersion = 30;
            const canvasOpacity = 0.8;
            
            // Color palette - very dark hues, almost black
            const colors = [
                p.color(45, 25, 35),     // Dark pink with hint of color
                p.color(55, 35, 45),     // Dark mauve with more presence
                p.color(35, 25, 25),     // Rich charcoal
                p.color(25, 45, 35),     // Dark green with subtle hue
                p.color(30, 40, 30),     // Forest dark with color
                p.color(20, 35, 25),     // Deep sage with visibility
                p.color(55, 45, 18),     // Dark yellow with warmth
                p.color(45, 40, 15),     // Golden dark with richness
                p.color(40, 20, 32)      // Dark plum with character
            ];
            
            p.setup = () => {
                // Create responsive canvas
                canvas = p.createCanvas(p.windowWidth, p.windowHeight);
                canvas.position(0, 0);
                canvas.style('z-index', '-1');
                canvas.style('position', 'fixed');
                canvas.style('pointer-events', 'none');
                
                // Initialize mouse position
                lastMouseX = p.mouseX;
                lastMouseY = p.mouseY;
                lastMouseTime = p.millis();
                
                // Disable context menu
                canvas.elt.oncontextmenu = (e) => {
                    e.preventDefault();
                    return false;
                };
            };
            
            p.draw = () => {
                // Create linear gradient from pinkish white to slightly gray
                for (let i = 0; i <= p.height; i++) {
                    let inter = p.map(i, 0, p.height, 0, 1);
                    let c = p.lerpColor(
                        p.color(250, 240, 248), // pinkish white
                        p.color(100, 40, 50), // slightly gray
                        inter
                    );
                    p.stroke(c);
                    p.line(0, i, p.width, i);
                }
                
                // Apply opacity effect
                let overlayColor = p.color(245, 232, 244, 255 * (1 - canvasOpacity));
                p.fill(overlayColor);
                p.noStroke();
                p.rect(0, 0, p.width, p.height);
                
                // Calculate mouse speed for dynamic line weight
                const deltaTime = p.millis() - lastMouseTime;
                const distance = p.dist(lastMouseX, lastMouseY, p.mouseX, p.mouseY);
                const speed = deltaTime > 0 ? distance / deltaTime : 0;
                
                // Add new particles if mouse moved
                if (distance > 0 && p.mouseX > 0 && p.mouseY > 0) {
                    const particlesToAdd = p.constrain(p.floor(inkFlow * 0.5), 1, 5);
                    
                    for (let i = 0; i < particlesToAdd; i++) {
                        // Vary position slightly for natural dispersion
                        const offsetX = p.random(-dispersion * 0.05, dispersion * 0.05);
                        const offsetY = p.random(-dispersion * 0.05, dispersion * 0.05);
                        
                        // Calculate size based on speed (faster = thinner)
                        const size = p.map(speed, 0, 15, 20, 2, true);
                        
                        particles.push({
                            x: p.mouseX + offsetX,
                            y: p.mouseY + offsetY,
                            size: p.max(size, 1),
                            alpha: 200,
                            color: colors[p.floor(p.random(colors.length))],
                            dispersion: dispersion * 0.1
                        });
                    }
                }
                
                // Update and draw particles
                for (let i = particles.length - 1; i >= 0; i--) {
                    const particle = particles[i];
                    
                    // Apply dispersion
                    particle.x += p.random(-particle.dispersion, particle.dispersion) * 0.1;
                    particle.y += p.random(-particle.dispersion, particle.dispersion) * 0.1;
                    
                    // Fade out
                    particle.alpha -= 2;
                    particle.size *= 0.97;
                    
                    // Draw particle
                    const col = p.color(
                        p.red(particle.color),
                        p.green(particle.color),
                        p.blue(particle.color),
                        p.constrain(particle.alpha, 0, 255)
                    );
                    
                    p.fill(col);
                    p.noStroke();
                    p.ellipse(particle.x, particle.y, particle.size);
                    
                    // Remove dead particles
                    if (particle.alpha <= 0 || particle.size <= 0.5) {
                        particles.splice(i, 1);
                    }
                }
                
                // Maintain particle limit
                while (particles.length > maxParticles) {
                    particles.shift();
                }
                
                // Update mouse tracking
                lastMouseX = p.mouseX;
                lastMouseY = p.mouseY;
                lastMouseTime = p.millis();
            };
            
            p.windowResized = () => {
                p.resizeCanvas(p.windowWidth, p.windowHeight);
            };
            
            p.touchMoved = () => {
                return false; // Prevent scrolling on mobile
            };
        };
 
        // Flower Animation with Highest Priority
        const floralSketch = (p) => {
            let flowers = [];
            const maxFlowers = 300;
            const petalColors = [
                p.color(255, 105, 180, .9), // Hot pink
                // p.color(255, 20, 147, .9), // Deep pink
                p.color(219, 112, 147, .9), // Pale violet red
                p.color(255, 182, 193, .9) // Light pink
            ];
            const centerColors = [
                p.color(255, 255, 220, .9), // Light cream yellow
                p.color(255, 250, 205, .9), // Lemon chiffon
                p.color(255, 255, 240, .9), // Ivory
                p.color(250, 250, 210, .9), // Light goldenrod yellow
                p.color(255, 248, 220, .9), // Cornsilk
                p.color(255, 255, 224, .9)  // Light yellow
            ];
 
            p.setup = () => {
                const canvas = p.createCanvas(p.windowWidth, p.windowHeight);
                canvas.position(0, 0);
                canvas.style('z-index', '99999');
                canvas.style('position', 'fixed');
                canvas.style('pointer-events', 'none');
                canvas.style('opacity', '1');
                
                p.background(0, 0); // Transparent background
                p.noStroke();
                p.angleMode(p.DEGREES);
            };
 
            p.draw = () => {
                p.clear(); // Clear with transparency
                
                // Update and display flowers
                for (let i = flowers.length - 1; i >= 0; i--) {
                    updateFlower(flowers[i]);
                    displayFlower(flowers[i]);
                    
                    // Remove faded flowers
                    if (flowers[i].opacity <= 0) {
                        flowers.splice(i, 1);
                    }
                }
            };
 
            function createFlower(x, y) {
                const flowerCount = p.floor(p.random(3, 8));
                for (let i = 0; i < flowerCount; i++) {
                    if (flowers.length < maxFlowers) {
                        const offsetX = p.random(-30, 30);
                        const offsetY = p.random(-30, 30);
                        const size = p.random(15, 40);
                        
                        flowers.push({
                            x: x + offsetX,
                            y: y + offsetY,
                            size: size,
                            rotation: p.random(360),
                            spinSpeed: p.random(-3, 3),
                            scale: 0,
                            targetScale: p.random(0.8, 1.2),
                            petalColor: petalColors[p.floor(p.random(petalColors.length))],
                            centerColor: centerColors[p.floor(p.random(centerColors.length))],
                            opacity: 255,
                            fadeSpeed: p.random(0.5, 2),
                            petalCount: p.floor(p.random(5, 9)),
                            life: p.random(50, 100)  // Half the time
                        });
                    }
                }
            }
 
            function updateFlower(flower) {
                flower.rotation += flower.spinSpeed;
                flower.scale = p.lerp(flower.scale, flower.targetScale, 0.1);
                flower.life--;
                flower.opacity = p.map(flower.life, 100, 0, 255, 0, true);
            }
 
            function displayFlower(flower) {
                p.push();
                p.translate(flower.x, flower.y);
                p.rotate(flower.rotation);
                p.scale(flower.scale);
                
                // Set opacity for entire flower
                const petalCol = p.color(p.red(flower.petalColor), p.green(flower.petalColor), p.blue(flower.petalColor), flower.opacity);
                const centerCol = p.color(p.red(flower.centerColor), p.green(flower.centerColor), p.blue(flower.centerColor), flower.opacity);
                
                // Draw petals
                p.fill(petalCol);
                for (let i = 0; i < flower.petalCount; i++) {
                    const angle = i * (360 / flower.petalCount);
                    p.push();
                    p.rotate(angle);
                    p.ellipse(flower.size * 0.4, 0, flower.size * 0.8, flower.size * 0.5);
                    p.pop();
                }
                
                // Draw center
                p.fill(centerCol);
                p.ellipse(0, 0, flower.size * 0.4);
                
                p.pop();
            }
 
            // Global click handler for flowers
            window.createFlowerAt = (x, y) => {
                createFlower(x, y);
            };
 
            p.windowResized = () => {
                p.resizeCanvas(p.windowWidth, p.windowHeight);
            };
        };
 
        // Initialize both sketches
        new p5(sketch, 'ink-canvas');
        new p5(floralSketch, 'flower-canvas');
 
        // Global click event handler for flower spawning
        document.addEventListener('click', (e) => {
            // Get click coordinates
            const x = e.clientX;
            const y = e.clientY;
            
            // Create flowers at click position
            if (window.createFlowerAt) {
                window.createFlowerAt(x, y);
            }
        });
 
        // Also handle touch events for mobile
        document.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const touch = e.touches[0];
            const x = touch.clientX;
            const y = touch.clientY;
            
            if (window.createFlowerAt) {
                window.createFlowerAt(x, y);
            }
        });
 
        // Global variables for countdown
        let countdownInterval;
        let targetTime;
 
        // Countdown Timer - Fixed Version
        function updateCountdown() {
            console.log('updateCountdown called');
            
            const timerElement = document.getElementById('countdown-timer');
            const mintButton = document.getElementById('mint-button');
            
            if (!timerElement) {
                console.error('countdown-timer element not found');
                return;
            }
            
            if (!mintButton) {
                console.error('mint-button element not found');
                return;
            }
            
            const now = new Date().getTime();
            const diff = targetTime - now;
            
            console.log('Time difference:', diff);
            
            if (diff <= 0) {
                timerElement.textContent = 'MINT OPEN!';
                mintButton.disabled = false;
                mintButton.textContent = 'Mint Now';
                clearInterval(countdownInterval);
                console.log('Countdown finished, minting enabled');
                return;
            }
            
            const hours = Math.floor(diff / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            const timeString = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            timerElement.textContent = timeString;
            
            console.log('Countdown updated:', timeString);
        }
 
        function initializeCountdown() {
            // Remove this line:
            // return

            console.log('Initializing countdown...');
            
            // Set target time to 5pm EST on 6/11/2025
            const targetDate = new Date('2025-06-11T17:00:00-05:00'); // 5pm EST
            targetTime = targetDate.getTime();
            
            console.log('Target time set to:', new Date(targetTime));
            
            // Update immediately
            updateCountdown();
            
            // Update every second
            countdownInterval = setInterval(updateCountdown, 1000);
        }
        
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeCountdown);
        } else {
            // DOM is already ready
            initializeCountdown();
        }
 
       // Web3Modal Wallet Connection
        let web3Modal;
        let provider;
        let accounts = [];
 
        // Initialize Web3Modal
        function initWeb3Modal() {
            web3Modal = new Web3Modal.Web3Modal({
                network: "mainnet",
                cacheProvider: true,
                providerOptions: {
                    walletconnect: {
                        package: WalletConnectProvider,
                        options: {
                            infuraId: "DEMO_PROJECT_ID" // You can use this demo ID
                        }
                    }
                }
            });
        }
 
        // Contract configuration
        const CONTRACT_ADDRESS = "0xD425c5935804be5eA08968F15346cAB7FEDd813b";
        const SEPOLIA_CHAIN_ID = "0xaa36a7"; // 11155111 in hex
        
        // Simplified ABI for minting
        const CONTRACT_ABI = [
            "function publicMint() external payable",
            "function publicMintBatch(uint256 quantity) external payable",
            "function freeMint(bytes32[] merkleProof) external",
            "function totalSupply() external view returns (uint256)",
            "function remainingSupply() external view returns (uint256)",
            "function isMintActive() external view returns (bool)",
            "function PUBLIC_PRICE() external view returns (uint256)",
            "function TIER2_PRICE() external view returns (uint256)",
            "function TIER3_PRICE() external view returns (uint256)"
        ];


        // Enhanced Multi-Wallet Connection Implementation
        document.addEventListener('DOMContentLoaded', () => {
            const walletButton = document.getElementById('connect-wallet');
            let currentProvider = null;
            
            if (!walletButton) {
                console.error('Wallet button not found!');
                return;
            }
            
            // Detect available wallets
            function detectWallets() {
                const wallets = [];
 
                wallets.push({ 
                    name: 'WalletConnect (Mobile)', 
                    provider: 'walletconnect' // Special identifier
                });
                
                // MetaMask
                if (window.ethereum?.isMetaMask) {
                    wallets.push({ name: 'MetaMask', provider: window.ethereum });
                }
                
                // Coinbase Wallet
                if (window.ethereum?.isCoinbaseWallet || window.coinbaseWalletExtension) {
                    wallets.push({ 
                        name: 'Coinbase Wallet', 
                        provider: window.ethereum?.isCoinbaseWallet ? window.ethereum : window.coinbaseWalletExtension 
                    });
                }
                
                // Rabby
                if (window.ethereum?.isRabby) {
                    wallets.push({ name: 'Rabby', provider: window.ethereum });
                }
                
                // Rainbow
                if (window.ethereum?.isRainbow) {
                    wallets.push({ name: 'Rainbow', provider: window.ethereum });
                }
                
                // Generic ethereum provider (fallback)
                if (window.ethereum && wallets.length === 0) {
                    wallets.push({ name: 'Web3 Wallet', provider: window.ethereum });
                }
                
                return wallets;
            }
            
            // Show wallet selection modal
            function showWalletModal() {
                const wallets = detectWallets();
                
                if (wallets.length === 0) {
                    alert('No Web3 wallet detected! Please install MetaMask, Coinbase Wallet, or another Ethereum wallet.');
                    return;
                }
                
                if (wallets.length === 1) {
                    // Only one wallet available, connect directly
                    connectWallet(wallets[0]);
                    return;
                }
                
          // Multiple wallets available, show selection
            const modalHtml = `
                <div id="wallet-modal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    font-family: system-ui, sans-serif;
                ">
                    <div style="
                        background: 
                            radial-gradient(ellipse at 30% 20%, rgba(255, 255, 255, 0.3) 0%, transparent 50%),
                            radial-gradient(ellipse at 80% 70%, rgba(240, 240, 240, 0.25) 0%, transparent 40%),
                            linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(220, 220, 220, 0.2) 30%, transparent 70%),
                            url('./images/koitsu.jpg');
                        background-size: 160%, 160%, 160%, 160%;
                        background-position: center;
                        background-repeat: no-repeat;
                        padding: 2rem;
                        border: 2px solid #000000;
                        border-radius: 12px;
                        max-width: 400px;
                        width: 90%;
                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                    ">
                        <h3 style="
                            margin: 0 0 1.5rem 0; 
                            text-align: center; 
                            color: #fff;
                            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
                            font-weight: 700;
                            font-size: 1.4rem;
                        ">Connect Wallet</h3>
                        <div id="wallet-options">
                            ${wallets.map(wallet => `
                                <button onclick="selectWallet('${wallet.name}')" style="
                                    display: block;
                                    width: 100%;
                                    padding: 1rem;
                                    margin-bottom: 0.5rem;
                                    border: 2px solid #000000;
                                    border-radius: 8px;
                                    background: rgba(255, 255, 255, 0.25);
                                    backdrop-filter: blur(8px);
                                    color: #fff;
                                    font-size: 1rem;
                                    font-weight: 600;
                                    cursor: pointer;
                                    transition: all 0.2s ease;
                                    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
                                " onmouseover="
                                    this.style.background='linear-gradient(to bottom, #c467ad, #f0b8d8)';
                                    this.style.backdropFilter='blur(4px)';
                                    this.style.color='white';
                                    this.style.textShadow='1px 1px 2px rgba(0, 0, 0, 0.5)';
                                    this.style.transform='translateY(-1px)';
                                    this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';
                                " onmouseout="
                                    this.style.background='rgba(255, 255, 255, 0.25)';
                                    this.style.backdropFilter='blur(8px)';
                                    this.style.color='#fff';
                                    this.style.textShadow='1px 1px 3px rgba(0, 0, 0, 0.7)';
                                    this.style.transform='translateY(0px)';
                                    this.style.boxShadow='none';
                                ">
                                    ${wallet.name}
                                </button>
                            `).join('')}
                        </div>
                        <button onclick="closeWalletModal()" style="
                            width: 100%;
                            padding: 0.8rem;
                            margin-top: 1rem;
                            border: 2px solid #000000;
                            border-radius: 6px;
                            background: rgba(255, 255, 255, 0.2);
                            backdrop-filter: blur(8px);
                            color: #fff;
                            cursor: pointer;
                            font-weight: 600;
                            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
                            transition: all 0.2s ease;
                        " onmouseover="
                            this.style.background='linear-gradient(to bottom, #c467ad, #f0b8d8)';
                            this.style.backdropFilter='blur(4px)';
                            this.style.color='white';
                            this.style.textShadow='1px 1px 2px rgba(0, 0, 0, 0.5)';
                            this.style.transform='translateY(-1px)';
                        " onmouseout="
                            this.style.background='rgba(255, 255, 255, 0.2)';
                            this.style.backdropFilter='blur(8px)';
                            this.style.color='#fff';
                            this.style.textShadow='1px 1px 3px rgba(0, 0, 0, 0.7)';
                            this.style.transform='translateY(0px)';
                        ">Cancel</button>
                    </div>
                </div>
            `;
                                
                document.body.insertAdjacentHTML('beforeend', modalHtml);
                
                // Store wallets globally for selection
                window.availableWallets = wallets;
            }
            
            // Connect to specific wallet
            async function connectWallet(wallet) {
                try {
                    console.log(`Connecting to ${wallet.name}...`);
                    
                    // Request account access
                    const accounts = await wallet.provider.request({ 
                        method: 'eth_requestAccounts' 
                    });
                    
                    if (accounts.length > 0) {
                        const address = accounts[0];
                        console.log('Connected to wallet:', address);
                        
                        // Store current provider
                        currentProvider = wallet.provider;
                        
                        // Update button with connected address
                        walletButton.textContent = `${address.substring(0, 6)}...${address.substring(38)}`;
                        walletButton.classList.add('connected');
                        
                        // Check for Milady NFT
                        checkMiladyNFT(address);
                        
                        // Optional: Switch to Ethereum mainnet if needed
                        try {
                            await wallet.provider.request({
                                method: 'wallet_switchEthereumChain',
                                params: [{ chainId: '0x1' }], // Ethereum mainnet
                            });
                        } catch (switchError) {
                            console.log('User rejected network switch or network not added');
                        }
                        
                        // Close modal if it exists
                        closeWalletModal();
                        
                    } else {
                        console.log('No accounts found');
                        alert('No accounts found. Please check your wallet.');
                    }
                    
                } catch (error) {
                    console.error('Error connecting to wallet:', error);
                    
                    if (error.code === 4001) {
                        alert('Wallet connection was rejected. Please try again and approve the connection.');
                    } else {
                        alert(`Failed to connect to ${wallet.name}. Please try again.`);
                    }
                }
            }
            
            // Global functions for modal
            window.selectWallet = (walletName) => {
                const wallet = window.availableWallets.find(w => w.name === walletName);
                if (wallet) {
                    connectWallet(wallet);
                }
            };
            
            window.closeWalletModal = () => {
                const modal = document.getElementById('wallet-modal');
                if (modal) {
                    modal.remove();
                }
            };
            
            walletButton.addEventListener('click', async (e) => {
                e.preventDefault();
                e.stopPropagation();
                console.log("WALLET CLICK DETECTED!");
                
                // Create flowers at button click position
                const rect = walletButton.getBoundingClientRect();
                const buttonCenterX = rect.left + rect.width / 2;
                const buttonCenterY = rect.top + rect.height / 2;
                
                if (window.createFlowerAt) {
                    window.createFlowerAt(buttonCenterX, buttonCenterY);
                }
                
                showWalletModal();
            });
                        
            // Listen for account changes (works with most wallets)
            if (window.ethereum) {
                window.ethereum.on('accountsChanged', (accounts) => {
                    if (accounts.length === 0) {
                        // User disconnected
                        walletButton.textContent = 'Connect Wallet';
                        walletButton.classList.remove('connected');
                        currentProvider = null;
                        console.log('Wallet disconnected');
                    } else {
                        // User switched accounts
                        const address = accounts[0];
                        walletButton.textContent = `${address.substring(0, 6)}...${address.substring(38)}`;
                        console.log('Account switched to:', address);
                        checkMiladyNFT(address);
                    }
                });
                
                // Listen for chain changes
                window.ethereum.on('chainChanged', (chainId) => {
                    console.log('Chain changed to:', chainId);
                });
            }
        });
 
        // Initialize on page load
        window.addEventListener('load', () => {
            initWeb3Modal();
        });
       
       // Whitelist checker function (replaces the mock Milady NFT check)
        async function checkMiladyNFT(address) {
            try {
                // Show loading state
                const miladyCheck = document.getElementById('milady-check');
                miladyCheck.style.display = 'flex';
                miladyCheck.innerHTML = `
                    <div class="milady-check-icon"></div>
                    <span>Checking whitelist status...</span>
                `;
                
                // Fetch whitelist data
                const response = await fetch('./whitelist-data.json');
                const data = await response.json();
                
                // Check if address is in the whitelist (case insensitive)
                const isWhitelisted = data.addresses.some(whitelistedAddress => 
                    whitelistedAddress.toLowerCase() === address.toLowerCase()
                );
                
                if (isWhitelisted) {
                    // Play confetti animation
                    confetti({
                        particleCount: 100,
                        spread: 70,
                        origin: { y: 0.6 },
                        zIndex: 20000,
                        colors: ['#ff69b4', '#db7093', '#ffb6c1', '#ffd700', '#daae29']
                    });
                    
                    // Show success message
                    miladyCheck.innerHTML = `
                        <div class="milady-check-icon"></div>
                        <span>Whitelisted! You qualify for early access!</span>
                    `;
                    miladyCheck.classList.add('verified');
                    
                    // Show celebration alert after confetti
                    setTimeout(() => {
                        showWhitelistModal();
                    }, 10);
                } else {
                    miladyCheck.innerHTML = `
                        <div class="milady-check-icon"></div>
                        <span>Address not found on whitelist - Standard mint price applies</span>
                    `;
                    miladyCheck.classList.remove('verified');
                }
                
            } catch (error) {
                console.error('Error checking whitelist:', error);
                const miladyCheck = document.getElementById('milady-check');
                miladyCheck.innerHTML = `
                    <div class="milady-check-icon"></div>
                    <span>Unable to verify whitelist status - Please try again</span>
                `;
            }
        }
       
       // Mock mint progress (in a real app, you'd listen to contract events)
       function simulateMintProgress() {
           let minted = 0;
           const max = 1000;
           const interval = setInterval(() => {
               if (minted >= max) {
                   clearInterval(interval);
                   return;
               }

               minted += Math.floor(Math.random() * 3) + 1;
              if (minted > max) minted = max;
              
              const percentage = (minted / max) * 100;
              document.getElementById('minted-count').textContent = `${minted}/${max}`;
              document.getElementById('progress-fill').style.width = `${percentage}%`;
          }, 5000);
      }
      
      simulateMintProgress();
      
      document.getElementById('mint-button').addEventListener('click', async () => {
    const walletButton = document.getElementById('connect-wallet');
    
    if (!walletButton.classList.contains('connected')) {
        alert('Please connect your wallet first');
        return;
    }
    
    if (!window.ethereum) {
        alert('No wallet detected. Please install MetaMask or another Ethereum wallet.');
        return;
    }
    
    // Add modal HTML if it doesn't exist yet
    if (!document.getElementById('mint-modal')) {
        document.body.insertAdjacentHTML('beforeend', `
            <div id="mint-modal" class="modal">
                <div class="modal-content">
                    <div id="modal-spinner" class="spinner-container">
                        <!-- Static ink design (shown first) -->
                        <svg id="static-ink" class="ink-design" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="50" cy="50" r="40" fill="none" stroke="#414344" stroke-width="2"/>
                            <path d="M30,50 Q50,20 70,50 T50,80 T30,50" fill="none" stroke="#414344" stroke-width="2"/>
                            <circle class="flower-center" cx="50" cy="50" r="8" fill="#cd594a"/>
                            <path class="flower-petal" d="M50,30 Q60,40 50,50 Q40,60 50,70 Q60,60 50,50 Q40,40 50,30" fill="#e38b79"/>
                        </svg>
                        
                        <!-- Loading ink animation (shown when transaction broadcasts) -->
                        <svg id="loading-ink" class="ink-design" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="display:none;">
                            <path d="M10,50 A40,40 0 1,1 90,50 A40,40 0 1,1 10,50" fill="none" stroke="#414344" stroke-width="8" stroke-linecap="round"/>
                            <path class="ink-drop" d="M50,30 Q60,10 70,30 T90,50 T70,70 T50,90 T30,70 T10,50 T30,30 T50,10" fill="none" stroke="#8c6a56" stroke-width="6" stroke-linecap="round"/>
                            <circle class="flower-center" cx="50" cy="50" r="10" fill="#cd594a"/>
                            <path class="flower-petal" d="M50,20 Q65,35 50,50 Q35,65 50,80 Q65,65 50,50 Q35,35 50,20" fill="#e38b79"/>
                        </svg>
                        
                        <!-- Success stamp with sakura and "Doll" in Japanese -->
                 <!-- Success stamp with sakura and Japanese character -->
              <!-- Success stamp with sakura and Japanese character -->
                <svg id="success-stamp" class="ink-design stamp" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" style="display:none;">
                    <!-- Sakura flower (keep as is) -->
                    <g class="stamp-mark sakura" transform="translate(35, 50)">
                        <!-- Five symmetrical petals arranged in perfect circle -->
                        <g transform="rotate(0)">
                            <ellipse cx="0" cy="-15" rx="6" ry="12" fill="#f7b8b8" stroke="#cd594a" stroke-width="1.2" />
                        </g>
                        <g transform="rotate(72)">
                            <ellipse cx="0" cy="-15" rx="6" ry="12" fill="#f7b8b8" stroke="#cd594a" stroke-width="1.2" />
                        </g>
                        <g transform="rotate(144)">
                            <ellipse cx="0" cy="-15" rx="6" ry="12" fill="#f7b8b8" stroke="#cd594a" stroke-width="1.2" />
                        </g>
                        <g transform="rotate(216)">
                            <ellipse cx="0" cy="-15" rx="6" ry="12" fill="#f7b8b8" stroke="#cd594a" stroke-width="1.2" />
                        </g>
                        <g transform="rotate(288)">
                            <ellipse cx="0" cy="-15" rx="6" ry="12" fill="#f7b8b8" stroke="#cd594a" stroke-width="1.2" />
                        </g>
                        
                        <!-- Center circle -->
                        <circle cx="0" cy="0" r="4" fill="#ffcfc9" stroke="#cd594a" stroke-width="1.2" />
                        
                        <!-- Symmetrical stamens -->
                        <g stroke="#414344" stroke-width="1" stroke-linecap="round">
                            <line x1="0" y1="-2" x2="0" y2="-6" />
                            <line x1="-2" y1="-1" x2="-4" y2="-3" />
                            <line x1="2" y1="-1" x2="4" y2="-3" />
                            <line x1="-1" y1="2" x2="-3" y2="4" />
                            <line x1="1" y1="2" x2="3" y2="4" />
                        </g>
                        
                        <!-- Stamen dots -->
                        <circle cx="0" cy="-6" r="1" fill="#414344" />
                        <circle cx="-4" cy="-3" r="1" fill="#414344" />
                        <circle cx="4" cy="-3" r="1" fill="#414344" />
                        <circle cx="-3" cy="4" r="1" fill="#414344" />
                        <circle cx="3" cy="4" r="1" fill="#414344" />
                    </g>
                    
                    <!-- Japanese character 霊 in styled text -->
                    <text x="72" y="58" class="stamp-mark japanese-text" 
                        font-family="'Noto Sans JP', serif" 
                        font-size="32" 
                        font-weight="500"
                        text-anchor="middle"
                        fill="#1a1520"
                        stroke="#0f0b12" 
                        stroke-width="0.3"
                        filter="drop-shadow(1px 1px 2px rgba(0,0,0,0.3))">霊</text>
                </svg>
                    </div>
                    <div id="modal-status" class="status-text">Preparing transaction...</div>
                    <div id="modal-details" class="transaction-details"></div>
                    <button id="modal-close" class="modal-close-button">Close</button>
                </div>
            </div>
        `);

        // Add modal styles
        document.head.insertAdjacentHTML('beforeend', `
            <style>
                .modal {
                    display: none;
                    position: fixed;
                    z-index: 1000;
                    left: 0;
                    top: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0, 0, 0, 0.7);
                    align-items: center;
                    justify-content: center;
                }
                
                .modal-content {
                    background: linear-gradient(135deg, #f5f0e8, #ece5da);
                    border: 2px solid #8c6a56;
                    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
                    border-radius: 12px;
                    width: 90%;
                    max-width: 500px;
                    padding: 30px;
                    text-align: center;
                    position: relative;
                    font-family: "Noto Serif JP", serif;
                }
                
                .spinner-container {
                    margin: 0 auto 20px;
                    width: 150px;
                    height: 150px;
                    position: relative;
                }
                
                .ink-design {
                    width: 100%;
                    height: 100%;
                    position: absolute;
                    top: 0;
                    left: 0;
                }
                
                .ink-drop {
                    stroke-dasharray: 300;
                    stroke-dashoffset: 300;
                    animation: ink-flow 3s infinite ease-in-out;
                }
                
                .flower-petal {
                    transform-origin: center;
                }
                
                /* Animation only runs when we add the 'animate' class */
                .loading-animate .flower-petal {
                    animation: flower-spin 6s infinite linear;
                }
                
                .stamp {
                    transform: rotate(-3deg);
                    opacity: 0;
                }
                
                .stamp.animate {
                    animation: stamp-appear 0.8s forwards;
                }
                
                .stamp-mark {
                    stroke-dasharray: 300;
                    stroke-dashoffset: 300;
                }
                
                .stamp.animate .stamp-mark {
                    animation: stamp-draw 1.2s forwards ease-out;
                }
                
                @keyframes ink-flow {
                    0% { stroke-dashoffset: 300; }
                    50% { stroke-dashoffset: 0; }
                    100% { stroke-dashoffset: 300; }
                }
                
                @keyframes flower-spin {
                    0% { transform: rotate(0deg); }
                    100% { transform: rotate(360deg); }
                }
                
                @keyframes stamp-appear {
                    0% { opacity: 0; transform: scale(1.2) rotate(-3deg); }
                    30% { opacity: 1; transform: scale(1.05) rotate(-1deg); }
                    100% { opacity: 1; transform: scale(1) rotate(-3deg); }
                }
                
                @keyframes stamp-draw {
                    0% { stroke-dashoffset: 300; }
                    100% { stroke-dashoffset: 0; }
                }
                
                .status-text {
                    font-size: 1.5rem;
                    margin-bottom: 15px;
                    color: #333;
                    font-weight: 500;
                }
                
                .transaction-details {
                    font-size: 0.9rem;
                    line-height: 1.5;
                    margin-bottom: 20px;
                    color: #555;
                    background: rgba(255, 255, 255, 0.5);
                    padding: 15px;
                    border-radius: 8px;
                    border-left: 3px solid #8c6a56;
                }
                
                .transaction-details a {
                    color: #cd594a;
                    text-decoration: none;
                    font-weight: 500;
                }
                
                .transaction-details a:hover {
                    text-decoration: underline;
                }
                
                .modal-close-button {
                    background: #cd594a;
                    color: white;
                    border: none;
                    padding: 10px 20px;
                    font-size: 1rem;
                    border-radius: 6px;
                    cursor: pointer;
                    transition: all 0.3s ease;
                    font-family: inherit;
                }
                
                .modal-close-button:hover {
                    background: #b04a3c;
                    transform: translateY(-2px);
                }
            </style>
        `);
    }
    
    try {
        const quantity = window.selectedQuantity || 1;
        console.log(`Client-side mint: ${quantity} NFTs`);

        // Get user's address
        const userAddress = await getCurrentWalletAddress();

        // Check if we're on Sepolia
        const chainId = await window.ethereum.request({ method: 'eth_chainId' });
        if (chainId !== '0xaa36a7') { // Sepolia chainId
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0xaa36a7' }],
                });
            } catch (switchError) {
                alert('Please switch to Sepolia testnet in your wallet');
                return;
            }
        }

        // Contract configuration
        const CONTRACT_ADDRESS = "0xD425c5935804be5eA08968F15346cAB7FEDd813b";
        const CONTRACT_ABI = [
            "function publicMint() external payable",
            "function publicMintBatch(uint256 quantity) external payable",
            "function isMintActive() external view returns (bool)"
        ];

        // Price calculation
        function calculateTotalCost(quantity) {
            const PUBLIC_PRICE = ethers.parseEther("0.01");
            const TIER2_PRICE = ethers.parseEther("0.00888");
            const TIER3_PRICE = ethers.parseEther("0.008");
            
            if (quantity < 10) {
                return PUBLIC_PRICE * BigInt(quantity);
            } else if (quantity < 20) {
                return TIER2_PRICE * BigInt(quantity);
            } else {
                return TIER3_PRICE * BigInt(quantity);
            }
        }

        // Create provider and contract instance
        const provider = new ethers.BrowserProvider(window.ethereum);
        const signer = await provider.getSigner();
        const contract = new ethers.Contract(CONTRACT_ADDRESS, CONTRACT_ABI, signer);

        // Calculate cost
        const cost = calculateTotalCost(quantity);
        console.log(`Cost: ${ethers.formatEther(cost)} ETH`);

        // Check user's balance
        const balance = await provider.getBalance(userAddress);
        if (balance < cost) {
            alert(`Insufficient balance. Need ${ethers.formatEther(cost)} ETH, have ${ethers.formatEther(balance)} ETH`);
            return;
        }

        // Check if minting is active
        try {
            const isMintActive = await contract.isMintActive();
            if (!isMintActive) {
                alert('Minting is not currently active');
                return;
            }
        } catch (error) {
            console.log('Could not check mint status:', error);
        }

        // Update button to show minting in progress
        const mintButton = document.getElementById('mint-button');
        const originalText = mintButton.textContent;
        mintButton.textContent = 'Minting...';
        mintButton.disabled = true;
        
        // Show the mint modal with static ink design
        const mintModal = document.getElementById('mint-modal');
        const modalStatus = document.getElementById('modal-status');
        const modalDetails = document.getElementById('modal-details');
        const modalClose = document.getElementById('modal-close');
        
        const staticInk = document.getElementById('static-ink');
        const loadingInk = document.getElementById('loading-ink');
        const successStamp = document.getElementById('success-stamp');

        // Initialize modal with static ink
        staticInk.style.display = 'block';
        loadingInk.style.display = 'none';
        successStamp.style.display = 'none';
        
        modalStatus.textContent = "Preparing transaction...";
        modalDetails.textContent = "Please confirm the transaction in your wallet.";
        modalClose.style.display = "none";
        mintModal.style.display = "flex";

        // Perform the mint transaction
        let tx;
        if (quantity === 1) {
            tx = await contract.publicMint({ 
                value: cost,
                gasLimit: 300000
            });
        } else {
            tx = await contract.publicMintBatch(quantity, { 
                value: cost,
                gasLimit: 300000 * quantity
            });
        }

        console.log('Transaction sent:', tx.hash);
        
        // Switch to animated loading ink
        staticInk.style.display = 'none';
        loadingInk.style.display = 'block';
        loadingInk.classList.add('loading-animate');
        
        modalStatus.textContent = "Transaction sent!";
        modalDetails.textContent = "Waiting for blockchain confirmation...";
        
        // Wait for confirmation
        const receipt = await tx.wait();
        
        console.log('Transaction confirmed!');
        console.log('Block:', receipt.blockNumber);
        console.log('Gas used:', receipt.gasUsed.toString());

        // Show success with confetti
        confetti({
            particleCount: 100,
            spread: 70,
            origin: { y: 0.6 }
        });

        // Switch to success stamp
        loadingInk.style.display = 'none';
        successStamp.style.display = 'block';
        // Trigger animation after a small delay to ensure display change takes effect
        setTimeout(() => {
            successStamp.classList.add('animate');
        }, 50);
        
        // Update modal with success info
        modalStatus.textContent = "✅ Minting successful!";
        modalDetails.innerHTML = `
            <p><strong>Transaction:</strong> ${tx.hash.substring(0, 10)}...${tx.hash.substring(tx.hash.length - 8)}</p>
            <p><strong>Cost:</strong> ${ethers.formatEther(cost)} ETH</p>
            <p><a href="https://sepolia.etherscan.io/tx/${tx.hash}" target="_blank">View on Etherscan</a></p>
        `;
        modalClose.style.display = "block";

        // Add event listener for close button
        modalClose.addEventListener('click', () => {
            mintModal.style.display = "none";
        });

        // Reset button
        mintButton.textContent = originalText;
        mintButton.disabled = false;
        
    } catch (error) {
        console.error('Minting error:', error);
        
        let errorMessage = 'Minting failed. ';
        
        if (error.code === 4001) {
            errorMessage += 'Transaction was rejected by user.';
        } else if (error.code === 'INSUFFICIENT_FUNDS') {
            errorMessage += 'Insufficient funds for transaction.';
        } else if (error.message && error.message.includes('execution reverted')) {
            errorMessage += `Contract error: ${error.reason || 'Transaction reverted'}`;
        } else {
            errorMessage += `Error: ${error.message}`;
        }
        
        // Update modal with error info if it's open
        const mintModal = document.getElementById('mint-modal');
        if (mintModal && mintModal.style.display === "flex") {
            const modalStatus = document.getElementById('modal-status');
            const modalDetails = document.getElementById('modal-details');
            const modalClose = document.getElementById('modal-close');
            
            // Show static ink for errors
            const staticInk = document.getElementById('static-ink');
            const loadingInk = document.getElementById('loading-ink');
            const successStamp = document.getElementById('success-stamp');
            
            staticInk.style.display = 'block';
            loadingInk.style.display = 'none';
            successStamp.style.display = 'none';
            
            modalStatus.textContent = "❌ Minting failed";
            modalDetails.textContent = errorMessage;
            modalClose.style.display = "block";
            
            // Add event listener for close button
            modalClose.addEventListener('click', () => {
                mintModal.style.display = "none";
            });
        } else {
            // Modal isn't open yet - just show alert
            alert(errorMessage);
        }

        // Reset button
        const mintButton = document.getElementById('mint-button');
        mintButton.textContent = 'Mint Now';
        mintButton.disabled = false;
    }
});

    async function getCurrentWalletAddress() {
        const accounts = await window.ethereum.request({ method: 'eth_accounts' });
        return accounts[0];
    }


      // Enhanced interaction hints
      let hintTimer;
      function showInkHint() {
          const hint = document.querySelector('.ink-interaction-hint');
          if (hint) {
              hint.style.opacity = '1';
              clearTimeout(hintTimer);
              hintTimer = setTimeout(() => {
                  hint.style.opacity = '0.7';
              }, 3000);
          }
      }

      // Show whitelist success modal
        function showWhitelistModal() {
            const modalHtml = `
                <div id="whitelist-modal" style="
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0, 0, 0, 0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 10000;
                    font-family: system-ui, sans-serif;
                ">
                    <div style="
                        background: 
                            radial-gradient(ellipse at 30% 20%, rgba(255, 255, 255, 0.3) 0%, transparent 50%),
                            radial-gradient(ellipse at 80% 70%, rgba(240, 240, 240, 0.25) 0%, transparent 40%),
                            linear-gradient(135deg, rgba(255, 255, 255, 0.15) 0%, rgba(220, 220, 220, 0.2) 30%, transparent 70%),
                            url('./images/koitsu.jpg');
                        background-size: 160%, 160%, 160%, 160%;
                        background-position: center;
                        background-repeat: no-repeat;
                        padding: 2rem;
                        border: 2px solid #000000;
                        border-radius: 12px;
                        max-width: 400px;
                        width: 90%;
                        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
                        text-align: center;
                    ">
                
                    <h3 style="
                        margin: 0 0 1.5rem 0;
                        text-align: center;
                        color: #2d5016;
                        text-shadow: 
                            2px 2px 0px #1a3009,
                            4px 4px 0px #0f1f05,
                            6px 6px 8px rgba(0, 0, 0, 0.4),
                            inset 0 0 0 2px #4a7c2a;
                        font-weight: 900;
                        font-size: 1.4rem;
                        background: linear-gradient(145deg, #4a7c2a, #2d5016, #1a3009);
                        background-clip: text;
                        -webkit-background-clip: text;
                        -webkit-text-fill-color: transparent;
                        filter: drop-shadow(1px 1px 0px #7fb069) drop-shadow(-1px -1px 0px #7fb069);
                        letter-spacing: 1px;
                    ">You are Whitelisted!</h3>
                        <p style="
                            color: #fff;
                            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7);
                            margin-bottom: 2rem;
                            font-size: 1rem;
                            line-height: 1.4;
                        ">Congratulations! You qualify for early access and special mint pricing.</p>
                        <button onclick="closeWhitelistModal()" style="
                            width: 100%;
                            padding: 1rem;
                            border: 2px solid #000000;
                            border-radius: 8px;
                            background: linear-gradient(to bottom, #c467ad, #f0b8d8);
                            backdrop-filter: blur(4px);
                            color: white;
                            font-size: 1rem;
                            font-weight: 600;
                            cursor: pointer;
                            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
                            transition: all 0.2s ease;
                        " onmouseover="
                            this.style.background='linear-gradient(to bottom, #d57ac0, #f5c8e0)';
                            this.style.transform='translateY(-1px)';
                            this.style.boxShadow='0 4px 8px rgba(0, 0, 0, 0.2)';
                        " onmouseout="
                            this.style.background='linear-gradient(to bottom, #c467ad, #f0b8d8)';
                            this.style.transform='translateY(0px)';
                            this.style.boxShadow='none';
                        ">
                            Dismiss
                        </button>
                    </div>
                </div>
            `;
                                    
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        // Global function to close whitelist modal
        window.closeWhitelistModal = () => {
            const modal = document.getElementById('whitelist-modal');
            if (modal) {
                modal.remove();
            }
        };

      // Add this to your existing JavaScript section
       document.addEventListener('DOMContentLoaded', () => {
           let selectedQuantity = 1;
           
           // Quantity button functionality
           const quantityButtons = document.querySelectorAll('.quantity-btn');
           const totalPriceElement = document.getElementById('total-price');
           const quantityDiscountElement = document.getElementById('quantity-discount');
           const mintButton = document.getElementById('mint-button');
           
           // Price tiers from your contract
           const PUBLIC_PRICE = 0.01;
           const TIER2_PRICE = 0.00888; // 10-19 mints
           const TIER3_PRICE = 0.008; // 20 mints
           
           function calculatePrice(quantity) {
               if (quantity < 10) {
                   return quantity * PUBLIC_PRICE;
               } else if (quantity < 20) {
                   return quantity * TIER2_PRICE;
               } else {
                   return quantity * TIER3_PRICE;
               }
           }
           
           function updatePriceDisplay() {
               const totalPrice = calculatePrice(selectedQuantity);
               const regularPrice = selectedQuantity * PUBLIC_PRICE;
               const savings = regularPrice - totalPrice;
               
               totalPriceElement.textContent = `${totalPrice.toFixed(4)} ETH`;
               
               if (savings > 0) {
                   const discountPercent = ((savings / regularPrice) * 100).toFixed(1);
                   quantityDiscountElement.textContent = `Save ${discountPercent}% (${savings.toFixed(4)} ETH)`;
                   quantityDiscountElement.style.display = 'block';
               } else {
                   quantityDiscountElement.style.display = 'none';
               }
               
               // Update mint button text
               if (mintButton && !mintButton.disabled) {
                   mintButton.textContent = `Mint ${selectedQuantity} NFT${selectedQuantity > 1 ? 's' : ''}`;
               }
           }
           
           quantityButtons.forEach(button => {
               button.addEventListener('click', (e) => {
                   // Remove active class from all buttons
                   quantityButtons.forEach(btn => btn.classList.remove('active'));
                   
                   // Add active class to clicked button
                   button.classList.add('active');
                   
                   // Update selected quantity
                   selectedQuantity = parseInt(button.dataset.quantity);
                   
                   // Update price display
                   updatePriceDisplay();
                   
                   // Add satisfying haptic feedback (if supported)
                   if ('vibrate' in navigator) {
                       navigator.vibrate(50);
                   }
               });
           });
           
           // Initialize price display
           updatePriceDisplay();
           
           // Make selectedQuantity available globally for mint function
           window.selectedQuantity = selectedQuantity;
           
           // Update the global selectedQuantity when it changes
           const originalAddEventListener = quantityButtons.forEach;
           quantityButtons.forEach(button => {
               button.addEventListener('click', () => {
                   window.selectedQuantity = selectedQuantity;
               });
           });
       });

      // Show hint when user stops moving mouse
      document.addEventListener('mousemove', showInkHint);
      
      // Auto-hide ink interaction hint after user starts creating ink
      let hasCreatedInk = false;
      document.addEventListener('mousemove', () => {
          if (!hasCreatedInk) {
              setTimeout(() => {
                  hasCreatedInk = true;
                  const hint = document.querySelector('.ink-interaction-hint');
                  if (hint) {
                      hint.style.transition = 'opacity 2s ease-out';
                      hint.style.opacity = '0';
                      setTimeout(() => {
                          hint.style.display = 'none';
                      }, 2000);
                  }
              }, 3000);
          }
      });
  </script>
</body>
</html>